# Decisions

## Active

### D-001: Монолитный Next.js (App Router)
**Решение**: Всё в одном Next.js приложении вместо microservices.
**Причина**: MVP-стадия, один разработчик, минимальная инфраструктурная сложность. Vercel даёт SSR + API routes из коробки.

### D-002: OpenAI REST API напрямую (без SDK)
**Решение**: Вызовы OpenAI через fetch вместо официального SDK.
**Причина**: Больше контроля над запросами, меньше абстракций, SDK в зависимостях но используется только для типов.

### D-003: Supabase без аутентификации
**Решение**: Anon-ключ с полным RLS-доступом, без user auth.
**Причина**: MVP без аккаунтов. Отчёты доступны по уникальному ID (nanoid 12 символов).

### D-004: USDT (Polygon) для платежей
**Решение**: Криптовалютные платежи вместо Stripe.
**Причина**: Глобальная доступность, без KYC, мгновенные транзакции, нет recurring complexity.

### D-005: Screenshots через thum.io
**Решение**: Внешний сервис для скриншотов вместо Puppeteer/Playwright.
**Причина**: Не нужен headless browser на сервере, работает на Vercel serverless.

### D-006: Промо-коды в памяти процесса
**Решение**: Лимиты промо-кодов хранятся в RAM (переменные модуля).
**Причина**: Простота. Ограничение: при рестарте/редеплое счётчики сбрасываются.

### D-007: Раздельные таблицы для каждого инструмента
**Решение**: `reports`, `ship_reports`, `paywall_reports` — отдельные таблицы вместо единой.
**Причина**: Разная структура данных (Roast = score/categories, Ship = pass/fail counters).
